---
layout:     post
title:      "UBoot-添加自定义命令"
subtitle:   "S5PV210 UBoot Command"
date:       2017-03-09 18:00:00
author:     "陈登龙"
header-img: "img/post-bg-uboot.jpg"
catalog: true
tags:
    - UBoot
---

# UBoot-添加自定义命令

这次我们来为上次我们移植成功的UBoot添加一个命令：**my_name**, 这个命令可以打印我们的名称。我们通过添加这个命令来了解如何在UBoot中添加一个命令。


步骤如下：
**1.在common目录下添加：cmd_myname.c**

``` 
#我们直接cp
cp cmd_version.c cmd_myname.c
```

**2.修改cmd_myname.c**

``` c

#include <common.h>
#include <command.h>
/* 我们不需要version的头文件 */
//#include <version.h>
#include <linux/compiler.h>

/* 输入你的名称 */
const char __weak name_string[] = "orange";

/* 修改成do_myname */
int do_name(cmd_tbl_t *cmdtp, int flag, int argc, char * const argv[])
{
	/* 打印出来 */
	printf("\n%s\n", name_string);
	return 0;
}
/*
 * myname是命令的名称
 * do_name：是上面的函数名
 * paint name：对这个命令的描述
 */
U_BOOT_CMD(
	myname,	1,		1,	do_name,
	"print name",
	""
);
```


**3.修改Makefile，增加对cmd_myname.c的编译**

``` makefile
#我们在cmd_version.o后面加上
COBJS-y += cmd_version.o
COBJS-y += cmd_myname.o
```


重新make，之后测试：
输入help，可以看到我们的myname命令
``` 
help
```

输入myname:

``` 
myname
```

会打印出我们的名字：

``` 
orange
```
如下图：
![MyName][1]

这样，我们的myname命令就添加完成了。


  [1]: https://cheng-zhi.github.io/img/UBoot/post-2017-03-09-MyName.png